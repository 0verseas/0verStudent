<!DOCTYPE html>
<html>
<head>
	<!-- Google Analytics -->
	<script src="../env.js"></script>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		if (env.isProduction === true) {
			ga('create', 'UA-108527915-4', 'auto');
		} else {
			ga('create', 'UA-108527915-5', 'auto');
		}
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->
	<meta charset="utf-8">
	<title>申請資料填報系統</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="overseas">
	<meta name="author" content="overseas">
	<!-- favicons -->
	<link rel="apple-touch-icon" sizes="180x180" href="https://api.overseas.ncnu.edu.tw/0verseas-favicons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://api.overseas.ncnu.edu.tw/0verseas-favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://api.overseas.ncnu.edu.tw/0verseas-favicons/favicon-16x16.png">
	<link rel="manifest" href="https://api.overseas.ncnu.edu.tw/0verseas-favicons/manifest.json">
	<link rel="mask-icon" href="https://api.overseas.ncnu.edu.tw/0verseas-favicons/safari-pinned-tab.svg" color="#5bbad5">
	<!-- <script src="../js/browser.js"></script> -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/CarlosBonetti/jquery-loading/dist/jquery.loading.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.11.2/sweetalert2.min.css">
	<!-- Custom styles for this template -->
	<link href="css/style.css" rel="stylesheet">
	<link href="css/<%= current.source %>.css" rel="stylesheet">
	<link rel="stylesheet" href="./css/loading.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.min.js" integrity="sha256-WRc/eG3R84AverJv0zmqxAmdwQxstUpqkiE+avJ3WSo=" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/gh/CarlosBonetti/jquery-loading/dist/jquery.loading.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.11.2/sweetalert2.min.js"></script>
	<script src="./js/student.js"></script>
	<script>
		if (env.isProduction === true) {
			console.log = function() {}
		}
	</script>
</head>
<body>
	<%
	const _processPageList = [ // 填寫資料頁面列表
	'systemChoose',
	'qualify1',
	'qualify2',
	'qualify3',
	'personalInfo',
	'educationInfo',
	'olympia',
	'admissionSelection',
	'grade',
	'placementSelection',
	'result',
	'downloadDocs',
	'uploadReviewItems'
	];
	%>

	<% include components/_loading %>
	<div id="clock" align="center"></div><!-- 台灣時間時鐘 -->
	<script>
		//時鐘
		serverTime();

		//補零
		function fillZero(i){
			if(i < 10) {
				i = "0" + i;
			}
			return i;
		}

		//聽說是伺服器時間
		function serverTime(){
			var xhr = null;
			if(window.XMLHttpRequest){
				xhr = new window.XMLHttpRequest();
			}else{ // ie
				xhr = new ActiveObject("Microsoft")
			}
			// 通過get的方式請求
			xhr.open("get","/");
			xhr.send(null);
			// 監聽請求狀態變化
			xhr.onreadystatechange = function(){
				var time = null,
						curDate = null;
				if(xhr.readyState===2){
					/**
					 * XMLHttpRequest.readyState值->說明
					 *
					 * 0->XMLHttpRequest請求物件已建立但尚未初始化
					 * 1->已與伺服器連線，準備好傳送一個request但還沒傳送
					 * 2->傳送request至伺服器且伺服器已接收，並可讀取回應的header
					 * 3->請求處理中，正在接收回應（已經接收完header但訊息部份尚未接收完成）
					 * 4->請求載入完成，回應已經被完全接收並就緒
					 * ==以下為失敗狀態==
					 * 200->"OK"
					 * 404->page not found
					 */
					// 抓出回應頭裡的時間戳記
					time = xhr.getResponseHeader("Date");
					console.log(xhr.getAllResponseHeaders());
					curDate = new Date(time);
					document.getElementById("clock").innerHTML = "臺灣當地時間(<strong>UTC+8</strong>)現在是"+curDate.getFullYear()+" / "+(curDate.getMonth()+1)+" / "+curDate.getDate()+"&nbsp;&nbsp;&nbsp;"+fillZero(curDate.getHours())+" : "+fillZero(curDate.getMinutes())/*+" : "+curDate.getSeconds()*/+"<br/><small>(僅供參考，可能因網路延遲等因素產生誤差)</small>";
					timeS(time); //讓前端自己算時間
				}
			}
		}

		//前端自己算＋更新時間
		function timeS(time) {
			var curDate = new Date(time);
			var year = curDate.getFullYear();
			var month = curDate.getMonth()+1; //陣列的月份是以數列的方式表示，只有月份會使用 0~11 的方式顯示
			var day = curDate.getDate();
			var hour = curDate.getHours();
			var min = curDate.getMinutes();
			var sec = curDate.getSeconds();
			setInterval(timeGo,1000); //定時1秒
			function timeGo(){ //as time go by
				sec = sec + 1;
				if(sec == 60){ //在非洲，每60秒就有一分鐘過去
					sec = 0;
					min++;
					if(min == 60){ //靜止的時針，刻下了時間  ──山崎エリイ〈Starlight〉
						min = 0;
						hour++;
						if(hour == 24){ //大學畢業後就很少看到的時刻（活力的一天，從睡覺開始）
							hour = 0;
							day++;
							if(day >= 29){ //孟仲季+春夏秋冬
								if(month == 2){
									/**
									 * 〔格里曆閏年規則〕
									 *
									 * 西元年份除以4不可整除，為平年。
									 * 西元年份除以4可整除，且除以100不可整除，為閏年。
									 * 西元年份除以100可整除，且除以400不可整除，為平年。
									 * 西元年份除以400可整除，為閏年。
									 */
									if((year%4==0 && year%100!=0) || year%400==0){ //閏年 leap year
										if(day == 30){ //閏年的2月有29天
											day = 1;
											month++;
										}
									}else { //平年
										day = 1;
										month++;
									}
								}else if(month==4 || month==6 || month==9 || month==11){ //小月
									if(day == 31){
										day = 1;
										month++;
									}
								}else{ //大月
									if(day == 32){
										day = 1;
										month++;
									}
								}

								if(month == 13){ //一元復始，萬象更新。Happy New Year!
									month = 1;
									year++;
								}
							}
						}
					}
				}
				document.getElementById("clock").innerHTML = "臺灣當地時間(<strong>UTC+8</strong>)現在是"+year+" / "+month+" / "+day+"&nbsp;&nbsp;&nbsp;"+fillZero(hour)+" : "+fillZero(min)+" : "+fillZero(sec)+"<br/><small>(僅供參考，可能因網路延遲等因素產生誤差)</small>";
			}

		}
	</script>
	<div id="app" class="container">
		<nav class="navbar header navbar-expand-lg navbar-light">
			<span class="navbar-brand" style="height: 35px">
				<a id="logo" href="./">
					<img
					src="/img/logo.png"
					height="30"
					class="d-inline-block align-top"
					/>
					<span class="hidden-sm-down">海外聯合招生委員會 -</span> 申請資料填報系統
				</a>
			</span>

			<% if (_processPageList.indexOf(current.source) > -1 || current.source === 'uploadReviewItems') { %>
				<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav mr-auto"></ul>
					<div class="form-inline my-2 my-lg-0">
						<small class="greet mr-2"></small>
						<button class="btn btn-danger" id="btn-logout"><i class="fa fa-sign-out" aria-hidden="true"></i> 登出</button>
					</div>
				</div>
			<% } %>
		</nav>
		<div class="alert alert-danger mt-2 alert-emailVerify hide" role="alert">
			<strong>注意！</strong> 您的信箱尚未驗證，請儘速前往填寫信箱開啟驗證信。若您未收到驗證信，請按 <a id="btn-mailResend" href="javascript:;">這裡</a> 重送驗證信。
		</div>

		<hr>

		<% if (_processPageList.indexOf(current.source) > -1) { %>
		<div class="row">
			<div class="col-lg-3">
				<div class="list-group">
					<a href="systemChoose.html" class="nav-item list-group-item list-group-item-action nav-systemChoose <%= 'qualify1qualify2qualify3systemChoose'.includes(current.source) ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　資格檢視 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i></a>
					<a href="personalInfo.html" class="nav-item list-group-item list-group-item-action nav-personalInfo <%= current.source === 'personalInfo' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　個人基本資料 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i></a>
					<a href="educationInfo.html" class="nav-item list-group-item list-group-item-action nav-educationInfo hide <%= current.source === 'educationInfo' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　入學資料 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i></a>
					<a href="olympia.html" class="nav-item list-group-item list-group-item-action nav-olympia hide <%= current.source === 'olympia' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　奧林匹亞志願 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i></a>
					<a href="admissionSelection.html" class="nav-item list-group-item list-group-item-action nav-admissionSelection <%= current.source === 'admissionSelection' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　個人申請志願 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i> <div class="tip-personal-info-first">&emsp;<small class="text-danger">(請先填寫個人基本資料)</small></div> <div class="tip-deadline">&emsp;<small class="text-danger">(非開放時間)</small></div> </a>
					<a href="grade.html" class="nav-item list-group-item list-group-item-action nav-grade hide <%= current.source === 'grade' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　聯合分發成績採計方式 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i></a>
					<a href="placementSelection.html" class="nav-item list-group-item list-group-item-action nav-placementSelection hide <%= current.source === 'placementSelection' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　聯合分發志願 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i> <div class="tip-grade-first">&emsp;<small class="text-danger">(請先選擇聯合分發採計方式)</small></div> <div class="tip-placement-deadline">&emsp;<small class="text-danger">(非開放時間)</small></div> </a>
					<a href="result.html" class="nav-item list-group-item list-group-item-action nav-result <%= current.source === 'result' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　志願檢視</a>
				</div>
				<hr>
				<button type="button" id="btn-all-set" class="btn btn-danger btn-block">完成填報</button>
				<div id="afterConfirmZone" style="display: none;">
					<hr>
					<div class="list-group">
						<a href="downloadDocs.html" class="nav-item list-group-item list-group-item-action nav-lalalalalala <%= current.source === 'downloadDocs' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　下載報名表件 <div class="tip-deadline"><small class="text-danger">(請先鎖定聯分志願)</small></div></a>
						<a href="uploadReviewItems.html" class="nav-item list-group-item list-group-item-action nav-uploadReviewItems <%= current.source === 'uploadReviewItems' ? 'active' : ''%>"><i class="fa fa-chevron-right hide icon-arrow" aria-hidden="true"></i> 　上傳備審資料 <i class="fa fa-square-o yet pull-right"></i><i class="done fa fa-check-square-o pull-right hide" aria-hidden="true"></i></a>
					</div>
					<hr>
					<button type="button" id="btn-uploadAndSubmit" class="btn btn-danger btn-block">確認上傳資料並提交</button>
					<small id="btn-uploadAndSubmit-hint" class="text-danger">注意：按下確認後，上傳的檔案就無法再做任何變更。</small>
				</div>
			</div>
			<div class="col-lg-9">
				<%- yield %>
			</div>
		</div>
		<script src="./js/navbar.js"></script>
		<% } else { %>
		<%- yield %>
		<% } %>
	</div>
	<a href="javascript:" id="arrow-top"><i class="fa fa-chevron-up"></i></a>
	<script>
		var loading = {
			start: function () {
				$('#loading-wrapper').show();
			},
			complete: function () {
				$('#loading-wrapper').hide();
			}
		};
		loading.start();
		// ===== Scroll to Top ====
		$(window).scroll(function() {
			if ($(this).scrollTop() >= 50) {
				$('#arrow-top').fadeIn("fast");
			} else {
				$('#arrow-top').fadeOut("fast");
			}
		});
		$('#arrow-top').click(function() {
			$('body,html').animate({
				scrollTop : 0
			}, 500);
		});
	</script>
	<script src="js/<%= current.source %>.js"></script>
	<footer class="container">
		<div class="row">
			<div class="col-12 text-center">
				<small>海外聯合招生委員會</small><br>
				<small>University Entrance Committee For Overseas Chinese Students</small><br />
				<small>地址：臺灣545南投縣埔里鎮大學路一號( 國立暨南國際大學 )</small><br />
				<small>E-mail：<a href="mailto:overseas@ncnu.edu.tw">overseas@mail.ncnu.edu.tw</a> 電話：+886-49-2910900( 代表號 )   傳真：+886-49-2911182</small>
			</div>
		</div>
	</footer>

</body>
</html>
